<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ewick Lab â€“ IA en quÃ©bÃ©cois (55+)</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'lab-dark': '#0f172a',
            'lab-accent': '#3b82f6',
            'lab-secondary': '#10b981'
          },
          fontFamily: { sans: ['Inter','system-ui','sans-serif'] }
        }
      }
    }
  </script>

  <style>
    body{ font-family:'Inter',system-ui,sans-serif; background:#0f172a; color:#e5e7eb }
    .section-card{ background:#1e293b; border-radius:14px; box-shadow:0 10px 18px rgba(0,0,0,.25) }
    .neon-glow{ text-shadow:0 0 6px #3b82f6, 0 0 14px #3b82f6 }
    .btn-lg{ padding:.95rem 1.35rem; font-weight:700; border-radius:999px }
    .pulse-ring{ position:absolute; inset:0; border-radius:9999px; box-shadow:0 0 0 0 rgba(59,130,246,.65); animation:pulse 2.2s ease-out infinite; pointer-events:none }
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(59,130,246,.65);opacity:1}70%{box-shadow:0 0 0 18px rgba(59,130,246,0);opacity:.25}100%{box-shadow:0 0 0 0 rgba(59,130,246,0);opacity:0}}
    @media (prefers-reduced-motion: reduce){ .pulse-ring{animation:none} }
  </style>

  <!-- Variables et instructions -->
  <script>
    const apiKey = "";
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
    const SYSTEM_INSTRUCTION_EDHICK =
      "Tu es EdHick GPT, l'intelligence artificielle quÃ©bÃ©coise et humoristique du Ewick Lab. Ton ton est amical, dÃ©contractÃ©, et tu utilises des expressions quÃ©bÃ©coises. Tu es brillant et crÃ©atif. Aide l'utilisateur Ã  gÃ©nÃ©rer des idÃ©es de contenu, des blagues, ou des concepts crÃ©atifs. Sois concis, drÃ´le, et commence toujours par une salutation en quÃ©bÃ©cois.";
  </script>
</head>

<body class="min-h-screen">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- EN-TÃŠTE -->
    <header class="text-center pt-10 pb-6 border-b border-white/10">
      <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold neon-glow leading-tight">
        Bienvenue au <span class="text-lab-accent">Ewick Lab</span><br class="hidden sm:block" />
        â€” lâ€™IA qui parle quÃ©bÃ©cois.
      </h1>
      <p class="mt-4 text-xl sm:text-2xl text-gray-200">
        Ici, on essaie lâ€™IA, on apprend tranquillementâ€¦ et on a du fun. ğŸ˜Š
      </p>

      <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
        <a href="https://m.me/Etropal68" target="_blank" rel="noopener"
           class="btn-lg bg-lab-accent text-white text-xl hover:bg-lab-accent/85 text-center">
          ğŸ’¬ Me parler sur Messenger
        </a>
        <a href="#essayer-ia"
           class="btn-lg bg-lab-secondary text-gray-900 text-xl hover:bg-lab-secondary/85 text-center">
          â–¶ï¸ Essayer lâ€™IA (simple)
        </a>
      </div>

      <p class="mt-3 text-sm text-gray-400">
        Besoin dâ€™aide? Clique sur Â« Me parler sur Messenger Â» â€” je te rÃ©ponds lÃ .
      </p>
    </header>

    <!-- NOUVELLE SECTION EN HAUT : NOTE CONVIVIALE -->
    <section class="section-card p-6 md:p-8 mt-8 text-center">
      <h2 class="text-3xl font-bold mb-3 text-lab-accent">On peut jaser de votre projet?</h2>
      <p class="text-xl text-gray-200 mb-5">
        Pas besoin dâ€™Ãªtre Â« techno Â». Dites-moi ce que vous voulez faire â€” petites vidÃ©os, idÃ©es pour Facebook,
        ou juste comprendre câ€™que lâ€™IA peut vous donner comme coup de main. On avance doucement, Ã©tape par Ã©tape.
      </p>
      <a href="https://m.me/Etropal68" target="_blank" rel="noopener"
         class="btn-lg bg-gray-600 text-white hover:bg-gray-700">ğŸ“© Mâ€™Ã©crire sur Messenger</a>
    </section>

    <!-- LE CONCEPT -->
    <section class="section-card p-6 md:p-8 mt-10">
      <h2 class="text-3xl font-bold mb-3 text-lab-accent">Câ€™est quoi, au juste?</h2>
      <p class="text-lg text-gray-200">
        Le Ewick Lab, câ€™est un endroit pour dÃ©couvrir lâ€™intelligence artificielle sans stress.
        Je vous montre des outils et je vous aide Ã  vous amuser avec, Ã  votre rythme.
      </p>

      <div class="grid md:grid-cols-3 gap-6 mt-6">
        <ul class="space-y-3 text-lg md:col-span-2">
          <li>ğŸ§  <b>EdHick GPT</b> â€” un pâ€™tit robot qui jase comme nous autres.</li>
          <li>ğŸ§© <b>Prompt Builder pour Sora</b> â€” des idÃ©es transformÃ©es en vidÃ©os rÃ©alistes.</li>
          <li>âœ¨ <b>LÃ©gendes QC GÃ©nÃ©rateur</b> â€” des histoires bien dâ€™ici.</li>
          <li>ğŸ—£ï¸ <b>Voix EdHick</b> â€” un projet de voix synthÃ©tique quÃ©bÃ©coise.</li>
        </ul>
        <!-- Remplacement par lâ€™image rÃ©elle -->
        <div class="lg:col-span-1 mt-2 md:mt-0 flex justify-center items-center">
          <img
            src="https://etropal00.github.io/photo.png"
            alt="Ewick Lab â€” cerveau robotique avec Ã©clair"
            loading="lazy"
            class="w-full h-48 object-cover rounded-lg border border-lab-accent/50 shadow-lg"
          >
        </div>
      </div>
    </section>

    <!-- ESSAYER Lâ€™IA -->
    <section id="essayer-ia" class="section-card p-6 md:p-8 mt-10">
      <h2 class="text-3xl font-bold mb-3 text-lab-accent">Essayer lâ€™IA (simple)</h2>
      <p class="text-lg text-gray-200 mb-4">
        Ã‰crivez une idÃ©e en une phrase. Lâ€™outil crÃ©e pour vous une consigne (Â« prompt Â») prÃªte Ã  utiliser.
      </p>

      <div class="bg-gray-800 p-5 rounded-lg border border-lab-secondary/40">
        <label for="promptBuilderInput" class="block text-gray-300 mb-2 text-lg">
          Votre idÃ©e (ex.: Â« Une poutine qui chante du CÃ©line Â»)
        </label>
        <textarea id="promptBuilderInput" rows="2"
                  class="w-full p-3 rounded-lg bg-gray-900 border border-gray-700 text-white focus:ring-2 focus:ring-lab-secondary focus:outline-none"></textarea>
        <div class="mt-4 flex items-center gap-3">
          <button onclick="generatePrompt()" id="generatePromptButton"
                  class="btn-lg bg-lab-secondary text-gray-900 hover:bg-lab-secondary/85" disabled>
            âœ¨ GÃ©nÃ©rer le prompt
          </button>
          <span id="promptLoading" class="hidden text-lab-secondary">Chargementâ€¦</span>
        </div>
        <div id="promptOutput" class="mt-4 p-4 bg-gray-900 rounded-lg text-lg text-lab-secondary hidden"></div>
      </div>

      <div class="mt-8">
        <h3 class="text-2xl font-bold mb-3 text-lab-accent">Parler Ã  EdHick (robot)</h3>
        <p class="text-lg text-gray-200 mb-3">Ã‰crivez une question, puis cliquez Â« Envoyer Â».</p>

        <div class="w-full h-[480px] bg-gray-800 rounded-xl p-4 border-4 border-double border-lab-accent/60 flex flex-col">
          <div id="chatContainer" class="flex-grow overflow-y-auto space-y-3 p-2">
            <div class="ai-message chat-message text-base bg-gray-600">
              Salut lâ€™artiste! Dites-moi ce que vous voulez crÃ©er â€” je vous aide sans vous casser la tÃªte.
            </div>
          </div>
          <div class="flex gap-2 pt-3">
            <input id="messageInput" type="text" placeholder="Ã‰crivez iciâ€¦"
                   class="flex-grow p-3 rounded-l-lg bg-gray-900 border border-lab-accent/40 text-white focus:ring-2 focus:ring-lab-accent focus:outline-none"
                   onkeydown="if(event.key==='Enter') sendMessage()">
            <button id="sendButton" onclick="sendMessage()"
                    class="bg-lab-accent text-white font-semibold px-6 rounded-r-lg hover:bg-lab-accent/85" disabled>
              Envoyer
            </button>
          </div>
          <div id="chatLoading" class="hidden text-center mt-2 text-lab-accent">EdHick rÃ©flÃ©chitâ€¦</div>
        </div>
      </div>
    </section>

    <!-- SOUTENIR -->
    <section class="section-card p-6 md:p-8 mt-10 text-center">
      <h2 class="text-3xl font-bold mb-3 text-lab-accent">Soutenir le Ewick Lab</h2>
      <p class="text-lg text-gray-200 mb-6">Chaque petit coup de main aide Ã  crÃ©er dâ€™autres essais faciles et amusants.</p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="#" class="btn-lg bg-lab-accent text-white hover:bg-lab-accent/85">ğŸ§ª Devenir membre</a>
        <a href="#" class="btn-lg bg-lab-secondary text-gray-900 hover:bg-lab-secondary/85">â˜• Offrir un cafÃ©</a>
      </div>
    </section>

    <!-- PIED DE PAGE -->
    <footer class="text-center mt-12 py-8 text-gray-400 border-t border-white/10">
      <p class="text-base">Â© 2025 Ewick Lab â€” une division du monde curieux dâ€™EdHick.</p>
      <p class="text-sm mt-1">PropulsÃ© par un peu dâ€™IAâ€¦ et beaucoup de bonne humeur.</p>
    </footer>
  </div>

  <!-- Bulle Messenger flottante -->
  <a href="https://m.me/Etropal68" target="_blank" rel="noopener"
     class="fixed bottom-6 right-6 bg-lab-accent hover:bg-lab-accent/85 text-white rounded-full w-16 h-16 flex items-center justify-center shadow-lg"
     aria-label="Contacter via Messenger">
    <span class="pulse-ring" aria-hidden="true"></span>
    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" class="w-8 h-8 relative">
      <path d="M8 0C3.6 0 0 3.25 0 7.25c0 2.3 1.1 4.36 2.9 5.71V16l2.6-1.44c.8.22 1.6.34 2.5.34 4.4 0 8-3.25 8-7.25S12.4 0 8 0zm.8 9.8L6.8 8.25 3.7 9.8l3.5-3.71 1.4 1.55 3.1-1.55L8.8 9.8z"/>
    </svg>
  </a>

  <!-- SCRIPTS -->
  <script>
    async function fetchWithBackoff(url, options, retries=3, delay=1000){
      for(let i=0;i<retries;i++){
        try{
          const res=await fetch(url,options);
          if(res.ok) return res;
          if(res.status===429 && i<retries-1){ await new Promise(r=>setTimeout(r,delay*Math.pow(2,i))); continue; }
          throw new Error(`Erreur HTTP: ${res.status} - ${res.statusText}`);
        }catch(e){
          if(i===retries-1) throw e;
          await new Promise(r=>setTimeout(r,delay*Math.pow(2,i)));
        }
      }
    }

    const chatContainer=document.getElementById('chatContainer');
    const messageInput=document.getElementById('messageInput');
    const sendButton=document.getElementById('sendButton');
    const chatLoading=document.getElementById('chatLoading');
    let chatHistory=[];

    window.onload=function(){
      if(sendButton) sendButton.disabled=false;
      const btn=document.getElementById('generatePromptButton');
      if(btn) btn.disabled=false;
    };

    function addMessage(text,isUser){
      const div=document.createElement('div');
      div.className=`chat-message text-white text-base ${isUser?'user-message':'ai-message'}`;
      div.innerHTML=text.replace(/\n/g,'<br>');
      chatContainer.appendChild(div);
      chatContainer.scrollTop=chatContainer.scrollHeight;
    }

    async function sendMessage(){
      const userQuery=messageInput.value.trim();
      if(!userQuery) return;
      addMessage(userQuery,true);
      messageInput.value='';
      chatHistory.push({role:"user",parts:[{text:userQuery}]});
      sendButton.disabled=true;
      chatLoading.classList.remove('hidden');

      const payload={
        contents:chatHistory,
        tools:[{"google_search":{}}],
        systemInstruction:{parts:[{text:SYSTEM_INSTRUCTION_EDHICK}]},
      };

      try{
        const res=await fetchWithBackoff(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
        const data=await res.json();
        const c=data.candidates?.[0];
        if(c && c.content?.parts?.[0]?.text){
          const t=c.content.parts[0].text;
          addMessage(t,false);
          chatHistory.push({role:"model",parts:[{text:t}]});
        }else{
          addMessage("DÃ©solÃ©, jâ€™ai pognÃ© un bug! Peux-tu reformuler?", false);
        }
      }catch(e){
        console.error("Erreur Gemini API:", e);
        addMessage("Oups, le serveur est parti en sucette. RÃ©essaie tantÃ´t, mon chum.", false);
      }finally{
        sendButton.disabled=false;
        chatLoading.classList.add('hidden');
      }
    }

    async function generatePrompt(){
      const idea=document.getElementById('promptBuilderInput').value.trim();
      const out=document.getElementById('promptOutput');
      const load=document.getElementById('promptLoading');
      const btn=document.getElementById('generatePromptButton');

      if(!idea){ out.innerText="Ã‰crivez une idÃ©e dâ€™abord ğŸ™‚"; out.classList.remove('hidden'); return; }

      btn.disabled=true; out.classList.add('hidden'); load.classList.remove('hidden');

      const q=`DÃ©taille et amÃ©liore cette idÃ©e pour crÃ©er un prompt ultra-rÃ©aliste de type Sora ou Gemini. Ajoute des dÃ©tails de camÃ©ra, d'Ã©clairage, de texture et de style visuel. Fais-le de maniÃ¨re crÃ©ative et amusante, en gardant l'esprit d'EdHick, mais produis le rÃ©sultat final en format de prompt technique (une seule ligne, en anglais, sans introductions ni explications, pour une IA gÃ©nÃ©rative). L'idÃ©e est : "${idea}"`;

      const payload={
        contents:[{parts:[{text:q}]}],
        systemInstruction:{parts:[{text:"Tu es un assistant expert en 'Prompt Engineering' pour les modÃ¨les de gÃ©nÃ©ration de vidÃ©o (Sora) et d'image (Gemini)."}]},
      };

      try{
        const res=await fetchWithBackoff(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
        const data=await res.json();
        const txt=data.candidates?.[0]?.content?.parts?.[0]?.text || "Erreur de gÃ©nÃ©ration du prompt.";
        out.innerText=txt.trim();
        out.classList.remove('hidden');
      }catch(e){
        console.error("Erreur Prompt Builder API:", e);
        out.innerText="DÃ©solÃ©, jâ€™ai fait un 404. RÃ©essaie ğŸ™‚";
        out.classList.remove('hidden');
      }finally{
        btn.disabled=false;
        load.classList.add('hidden');
      }
    }
  </script>
</body>
</html>
